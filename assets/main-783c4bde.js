const n={log:(...e)=>console.log("[WA]",...e),err:(...e)=>console.error("[WA]",...e)},B="/@/ynov-1733302243/ynov_adventure/new-map",p=[{id:"#TPA-IA",label:"IA"},{id:"#TPAINFO",label:"Informatique"},{id:"#TPACYBER",label:"Cybersécurité"},{id:"#TPAARCHI",label:"Architecture"},{id:"#TPABIM",label:"Bâtiment Numérique"},{id:"#TPAAUDIO",label:"Audiovisuel"},{id:"#TPADIGITAL",label:"DIGITAL IA"},{id:"#TPA3D",label:"3D"},{id:"#TPAHUB",label:"Accueil"}],A=3;function h(e,o,t,a=!0){var l,u;const r=(l=WA.ui)==null?void 0:l.actionBar;if(!(r!=null&&r.addButton))return n.err("actionBar indisponible"),!1;try{(u=r.removeButton)==null||u.call(r,e)}catch{}try{const c={id:e,label:o,callback:t,clickCallback:t};return a&&(c.bgColor="#2ea7ff",c.isGradient=!0),r.addButton(c),!0}catch{try{return r.addButton({id:e,label:o,callback:t,clickCallback:t}),!0}catch(d){return n.err("addButton error:",d),!1}}}function I(e){var o,t,a;try{(a=(t=(o=WA.ui)==null?void 0:o.actionBar)==null?void 0:t.removeButton)==null||a.call(t,e)}catch{}}const y="teleport-btn";let f=!1,i=0,m=[];WA.onInit().then(()=>{var a,r;let e=0;const o=20,t=()=>{if(e++,h(y,"Téléportation",T,!0)){n.log("Bouton Téléportation OK");return}e<o?setTimeout(t,200):n.err("Impossible d’ajouter le bouton Téléportation (action bar).")};t();try{(r=(a=WA.ui).registerMenuCommand)==null||r.call(a,"Téléportation",T),p.forEach(l=>{var u,c;return(c=(u=WA.ui).registerMenuCommand)==null?void 0:c.call(u,l.label,()=>{try{WA.nav.goToRoom(B+l.id)}catch(d){n.err("goToRoom error:",d)}})})}catch{n.log("registerMenuCommand non disponible — pas bloquant.")}setTimeout(()=>{P()},3e3)}).catch(e=>n.err("onInit error:",e));function T(){f||(f=!0,I(y),i=0,b())}function v(){g(),f=!1,h(y,"Téléportation",T,!0)}function b(){g();const e=Math.max(1,Math.ceil(p.length/A));i=Math.max(0,Math.min(i,e-1));const o=i*A,t=p.slice(o,o+A);i>0&&s("tp-prev","◀",()=>{i--,b()}),t.forEach((a,r)=>s(`tp-${o+r}`,a.label,()=>{try{WA.nav.goToRoom(B+a.id)}catch(l){n.err("goToRoom error:",l)}v()})),i<e-1&&s("tp-next","▶",()=>{i++,b()}),s("tp-close","✖",v)}function s(e,o,t){h(e,o,t,!1)&&m.push(e)}function g(){m.forEach(e=>I(e)),m=[]}function P(){if(WA.player.state.hasVariable("ynov_adventure_form_done")){n.log("Form already done");return}n.log("Form opened"),WA.player.state.saveVariable("ynov_adventure_form_done",!1),WA.controls.disablePlayerControls(),WA.ui.modal.openModal({title:"Formulaire de présentation",allowApi:!0,position:"center",allow:null,src:"https://blocksurvey.io/bienvenue-dans-ynov-adventure-PjQCcb1EQhKO8TJqwyy_BA?v=l",allowFullScreen:!0,closable:!1},()=>{n.log("Form closed"),WA.controls.restorePlayerControls()})}
//# sourceMappingURL=main-783c4bde.js.map
