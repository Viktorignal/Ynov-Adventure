{"version":3,"file":"main-c5791148.js","sources":["../../src/main.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n\n/* ============ LOGS ============ */\nconst L = {\n  log: (...a: any[]) => console.log(\"[WA]\", ...a),\n  err: (...a: any[]) => console.error(\"[WA]\", ...a),\n};\n\n/* ============ CONFIG ============ */\nconst MAP_URL = \"/@/ynov-1733302243/ynov_adventure/e-jpo\";\nconst ZONES: { id: string; label: string }[] = [\n  { id: \"#TPA-IA\",     label: \"IA\" },\n  { id: \"#TPAINFO\",    label: \"Informatique\" },\n  { id: \"#TPACYBER\",   label: \"Cybersécurité\" },\n  { id: \"#TPAARCHI\",   label: \"Architecture\" },\n  { id: \"#TPABIM\",     label: \"Bâtiment Numérique\" },\n  { id: \"#TPAAUDIO\",   label: \"Audiovisuel\" },\n  { id: \"#TPADIGITAL\", label: \"DIGITAL IA\" },\n  { id: \"#TPA3D\",      label: \"3D\" },\n  { id: \"#TPAHUB\",     label: \"Accueil\" },\n];\n\n/* ============ HELPERS ============ */\n/** Ajoute un bouton. Si l’instance refuse la couleur/gradient, on retente sans style. */\nfunction addButtonSafe(opts: {\n  id: string;\n  label: string;\n  onClick: () => void;\n  bgColor?: string;\n  isGradient?: boolean;\n}) {\n  const ab: any = (WA.ui as any)?.actionBar;\n  if (!ab?.addButton) {\n    L.err(\"actionBar.addButton introuvable\");\n    return;\n  }\n  const base: any = { id: opts.id, label: opts.label, callback: opts.onClick, clickCallback: opts.onClick };\n  try {\n    if (opts.bgColor !== undefined) base.bgColor = opts.bgColor;\n    if (opts.isGradient !== undefined) base.isGradient = opts.isGradient;\n    ab.addButton(base);\n    L.log(`Button added: ${opts.id} (with style if supported)`);\n  } catch (e) {\n    try {\n      ab.addButton({ id: opts.id, label: opts.label, callback: opts.onClick, clickCallback: opts.onClick });\n      L.log(`Button added: ${opts.id} (fallback no-style)`);\n    } catch (e2) {\n      L.err(`Failed to add button ${opts.id}:`, e2);\n    }\n  }\n}\nfunction removeButtonSafe(id: string) {\n  const ab: any = (WA.ui as any)?.actionBar;\n  try { ab?.removeButton?.(id); } catch {}\n}\n\n/* ======= ÉTAT TÉLÉPORTATION ======= */\nconst MAIN_TP_BTN_ID = \"teleport-btn\";\nlet tpOpen = false;\nlet tpButtonIds: string[] = [];\n\n/* ============ INIT ============ */\nWA.onInit().then(() => {\n  L.log(\"onInit OK\");\n\n  // Bouton TÉLÉPORTATION (disparaît quand le menu est ouvert)\n  addButtonSafe({\n    id: MAIN_TP_BTN_ID,\n    label: \"Téléportation\",\n    bgColor: \"#2ea7ff\",\n    isGradient: true,\n    onClick: () => openTeleportMenu(),\n  });\n\n  L.log(\"Buttons added\");\n}).catch((e) => L.err(\"onInit error:\", e));\n\n/* ============ TÉLÉPORTATION (liste simple, sans pagination) ============ */\nfunction openTeleportMenu() {\n  if (tpOpen) return;\n  tpOpen = true;\n\n  // On enlève le bouton principal pendant l’ouverture du menu\n  removeButtonSafe(MAIN_TP_BTN_ID);\n\n  drawTpButtons();\n}\n\nfunction closeTeleportMenu() {\n  removeTpButtons();\n  tpOpen = false;\n\n  // Ré-ajoute le bouton principal\n  addButtonSafe({\n    id: MAIN_TP_BTN_ID,\n    label: \"Téléportation\",\n    bgColor: \"#2ea7ff\",\n    isGradient: true,\n    onClick: () => openTeleportMenu(),\n  });\n}\n\nfunction drawTpButtons() {\n  removeTpButtons();\n\n  // Ajoute tous les boutons de zones (sans pagination/adaptation)\n  ZONES.forEach((z, idx) => {\n    addTpBtn(`tp-z-${idx}`, z.label, () => {\n      try { WA.nav.goToRoom(MAP_URL + z.id); } catch (e) { L.err(\"goToRoom error:\", e); }\n      // Referme le menu après TP\n      closeTeleportMenu();\n    });\n  });\n\n  // ✖ Fermer\n  addTpBtn(\"tp-close\", \"✖\", () => closeTeleportMenu());\n\n  L.log(`TP menu ouvert avec ${ZONES.length} zones (+ fermer).`);\n}\n\nfunction addTpBtn(id: string, label: string, cb: () => void) {\n  tpButtonIds.push(id);\n  const ab: any = (WA.ui as any)?.actionBar;\n  try {\n    ab.addButton({ id, label, callback: cb, clickCallback: cb });\n  } catch (e) {\n    L.err(`Failed to add TP sub-button ${id}:`, e);\n  }\n}\nfunction removeTpButtons() {\n  const ab: any = (WA.ui as any)?.actionBar;\n  tpButtonIds.forEach((id) => { try { ab.removeButton?.(id); } catch {} });\n  tpButtonIds = [];\n}\n\nexport {};\n"],"names":["L","a","MAP_URL","ZONES","addButtonSafe","opts","_a","ab","base","e2","removeButtonSafe","id","_b","MAIN_TP_BTN_ID","tpOpen","tpButtonIds","openTeleportMenu","e","drawTpButtons","closeTeleportMenu","removeTpButtons","z","idx","addTpBtn","label","cb"],"mappings":"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"}