{"version":3,"file":"main-398b40d0.js","sources":["../../src/main.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n\n/* ================== CONFIG ================== */\nconst MAP_URL = \"/@/ynov-1733302243/ynov_adventure/new-map\";\nconst ZONES: { id: string; label: string }[] = [\n  { id: \"#TPA-IA\",     label: \"IA\" },\n  { id: \"#TPAINFO\",    label: \"Informatique\" },\n  { id: \"#TPACYBER\",   label: \"Cybers√©curit√©\" },\n  { id: \"#TPAARCHI\",   label: \"Architecture\" },\n  { id: \"#TPABIM\",     label: \"B√¢timent Num√©rique\" },\n  { id: \"#TPAAUDIO\",   label: \"Audiovisuel\" },\n  { id: \"#TPADIGITAL\", label: \"DIGITAL IA\" },\n  { id: \"#TPA3D\",      label: \"3D\" },\n  { id: \"#TPAHUB\",     label: \"Accueil\" },\n];\n\n/* ===== Helpers ‚Äúcompat‚Äù ===== */\nfunction addActionButtonCompat(opts: {\n  id: string;\n  label: string;\n  onClick: () => void;\n  bgColor?: string;\n  isGradient?: boolean;\n  hoverColor?: string;\n}) {\n  const cfg: any = {\n    id: opts.id,\n    label: opts.label,\n    callback: opts.onClick,\n    clickCallback: opts.onClick, // selon version\n  };\n  // Styles (si support√©s par l‚Äôinstance, ils s‚Äôappliqueront ; sinon, ignor√©s)\n  if (opts.bgColor) cfg.bgColor = opts.bgColor;\n  if (opts.isGradient !== undefined) cfg.isGradient = opts.isGradient;\n  if (opts.hoverColor) cfg.hoverColor = opts.hoverColor;\n\n  (WA.ui as any).actionBar.addButton(cfg);\n}\nfunction removeActionButton(id: string) {\n  const ab: any = WA.ui.actionBar;\n  try { ab.removeButton?.(id); } catch {}\n}\n\n/* ===== T√©l√©portation : √©tat ===== */\nconst MAIN_TP_BTN_ID = \"teleport-btn\";\nlet tpOpen = false;\nlet tpPage = 0;\nlet tpButtonIds: string[] = [];\nconst IS_MOBILE =\n  /Mobi|Android/i.test(navigator.userAgent) ||\n  (window.matchMedia && window.matchMedia(\"(pointer:coarse)\").matches) ||\n  (typeof window !== \"undefined\" && window.innerWidth < 768);\n// Desktop = 3/page, Mobile = 1/page (si fallback action bar)\nconst PER_PAGE = IS_MOBILE ? 1 : 3;\n\nWA.onInit().then(() => {\n  // üü° Candidater ‚Äî couleur + gradient si support√©s (sinon style normal)\n  addActionButtonCompat({\n    id: \"candidater-btn\",\n    label: \"Candidater\",\n    bgColor: \"#edb911\",\n    isGradient: true,\n    onClick: () => {\n      try {\n        // @ts-ignore (selon version)\n        if (WA?.nav?.openTab) WA.nav.openTab(\"https://www.ynov.com/candidature\");\n        else window.open(\"https://www.ynov.com/candidature\", \"_blank\", \"noopener,noreferrer\");\n      } catch {\n        window.open(\"https://www.ynov.com/candidature\", \"_blank\", \"noopener,noreferrer\");\n      }\n    },\n  });\n\n  // üß≠ T√©l√©portation (le bouton dispara√Æt pendant que la liste est ouverte)\n  addActionButtonCompat({\n    id: MAIN_TP_BTN_ID,\n    label: \"T√©l√©portation\",\n    bgColor: \"#2ea7ff\",\n    isGradient: true,\n    onClick: () => openTeleportUI(),\n  });\n}).catch((e) => console.error(\"[WA] onInit error:\", e));\n\n/* === UI T√©l√©portation === */\nfunction openTeleportUI() {\n  if (tpOpen) return;\n  tpOpen = true;\n\n  // retire le bouton principal pendant l'ouverture de la liste\n  removeActionButton(MAIN_TP_BTN_ID);\n\n  // 1) Tenter une POPUP ANCR√âE (si un objet 'tp_anchor' existe dans la map)\n  //    -> Meilleur rendu mobile (vertical, natif)\n  try {\n    openTeleportPopupAnchored(\"tp_anchor\");\n    return;\n  } catch {\n    // 2) Sinon, fallback : sous-menu pagin√© dans l‚Äôaction bar\n    openTeleportActionBarFallback();\n  }\n}\n\nfunction closeTeleportUI() {\n  tpOpen = false;\n  // nettoie les sous-boutons du fallback si besoin\n  removeTpButtons();\n  // r√©tablit le bouton principal\n  addActionButtonCompat({\n    id: MAIN_TP_BTN_ID,\n    label: \"T√©l√©portation\",\n    bgColor: \"#2ea7ff\",\n    isGradient: true,\n    onClick: () => openTeleportUI(),\n  });\n}\n\n/* ---- Variante pr√©f√©r√©e : POPUP ancr√©e √† un objet de la map ---- */\nfunction openTeleportPopupAnchored(anchorObjectName: string) {\n  // On g√©n√®re les boutons (liste verticale native)\n  const buttons = ZONES.map((z) => ({\n    label: z.label,\n    callback: () => {\n      WA.nav.goToRoom(MAP_URL + z.id);\n      try { anchoredPopup?.close?.(); } catch {}\n      closeTeleportUI();\n    },\n  }));\n  buttons.push({\n    label: \"Fermer\",\n    callback: () => {\n      try { anchoredPopup?.close?.(); } catch {}\n      closeTeleportUI();\n    },\n  });\n\n  // IMPORTANT : l‚Äôid doit exister dans la map (Object Layer ‚Üí rectangle nomm√© 'tp_anchor')\n  let anchoredPopup: any;\n  anchoredPopup = WA.ui.openPopup(\n    anchorObjectName,\n    \"T√©l√©portation\\n\\nChoisissez une destination :\",\n    buttons\n  );\n}\n\n/* ---- Fallback : sous-menu pagin√© dans l‚Äôaction bar ---- */\nfunction openTeleportActionBarFallback() {\n  tpPage = 0;\n  drawTpButtons();\n}\n\nfunction drawTpButtons() {\n  removeTpButtons();\n\n  const totalPages = Math.max(1, Math.ceil(ZONES.length / PER_PAGE));\n  tpPage = Math.max(0, Math.min(tpPage, totalPages - 1));\n\n  const start = tpPage * PER_PAGE;\n  const slice = ZONES.slice(start, start + PER_PAGE);\n\n  // ‚óÄ\n  if (tpPage > 0) {\n    addTpBtn(\"tp-prev\", \"‚óÄ Pr√©c√©dent\", () => { tpPage -= 1; drawTpButtons(); });\n  }\n\n  // zones\n  slice.forEach((z, i) => {\n    addTpBtn(`tp-z-${start + i}`, z.label, () => {\n      WA.nav.goToRoom(MAP_URL + z.id);\n      // refermer apr√®s TP (si tu veux laisser ouvert, remplace par drawTpButtons();)\n      closeTeleportUI();\n    });\n  });\n\n  // ‚ñ∂\n  if (tpPage < totalPages - 1) {\n    addTpBtn(\"tp-next\", \"Suivant ‚ñ∂\", () => { tpPage += 1; drawTpButtons(); });\n  }\n\n  // ‚úñ\n  addTpBtn(\"tp-close\", \"‚úñ Fermer\", () => closeTeleportUI());\n}\n\nfunction addTpBtn(id: string, label: string, cb: () => void) {\n  tpButtonIds.push(id);\n  (WA.ui as any).actionBar.addButton({\n    id,\n    label,\n    callback: cb,\n    clickCallback: cb,\n  });\n}\nfunction removeTpButtons() {\n  const ab: any = WA.ui.actionBar;\n  tpButtonIds.forEach((id) => { try { ab.removeButton?.(id); } catch {} });\n  tpButtonIds = [];\n}\n\nexport {};\n"],"names":["MAP_URL","ZONES","addActionButtonCompat","opts","cfg","removeActionButton","id","_a","ab","MAIN_TP_BTN_ID","tpOpen","tpPage","tpButtonIds","IS_MOBILE","PER_PAGE","openTeleportUI","e","openTeleportPopupAnchored","openTeleportActionBarFallback","closeTeleportUI","removeTpButtons","anchorObjectName","buttons","z","anchoredPopup","drawTpButtons","totalPages","start","slice","addTpBtn","i","label","cb"],"mappings":"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"}