{"version":3,"file":"main-d9072b2e.js","sources":["../../src/main.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n\n// Logs\nconst log  = (...a: any[]) => console.log(\"[WA]\", ...a);\nconst err  = (...a: any[]) => console.error(\"[WA]\", ...a);\n\n// Config\nconst mapURL = \"/@/ynov-1733302243/ynov_adventure/new-map\";\nconst zones: { id: string; label: string }[] = [\n  { id: \"#TPA-IA\",     label: \"IA\" },\n  { id: \"#TPAINFO\",    label: \"Informatique\" },\n  { id: \"#TPACYBER\",   label: \"Cybersécurité\" },\n  { id: \"#TPAARCHI\",   label: \"Architecture\" },\n  { id: \"#TPABIM\",     label: \"Bâtiment Numérique\" },\n  { id: \"#TPAAUDIO\",   label: \"Audiovisuel\" },\n  { id: \"#TPADIGITAL\", label: \"DIGITAL IA\" },\n  { id: \"#TPA3D\",      label: \"3D\" },\n  { id: \"#TPAHUB\",     label: \"Accueil\" },\n];\n\n// État sous-menu TP\nlet tpOpen = false;\nlet tpPage = 0;\nconst PER_PAGE = 3;\nlet tpButtonIds: string[] = [];\n\nWA.onInit().then(() => {\n  log(\"onInit OK\");\n\n  // Candidater — nouvel onglet uniquement\n  WA.ui.actionBar.addButton({\n    id: \"candidater-btn\",\n    label: \"Candidater\",\n    callback: () => {\n      try {\n        // @ts-ignore selon version\n        if (WA?.nav?.openTab) WA.nav.openTab(\"https://www.ynov.com/candidature\");\n        else window.open(\"https://www.ynov.com/candidature\", \"_blank\", \"noopener,noreferrer\");\n      } catch {\n        window.open(\"https://www.ynov.com/candidature\", \"_blank\", \"noopener,noreferrer\");\n      }\n    },\n  });\n\n  // Téléportation — sous-menu paginé\n  WA.ui.actionBar.addButton({\n    id: \"teleport-btn\",\n    label: \"Téléportation\",\n    callback: () => toggleTeleportMenu(),\n  });\n\n  log(\"Buttons added\");\n}).catch((e) => err(\"onInit error:\", e));\n\n// Sous-menu TP\nfunction toggleTeleportMenu() {\n  if (tpOpen) { removeTpButtons(); tpOpen = false; return; }\n  tpPage = 0; drawTpButtons(); tpOpen = true;\n}\nfunction drawTpButtons() {\n  removeTpButtons();\n\n  const total = Math.max(1, Math.ceil(zones.length / PER_PAGE));\n  tpPage = Math.max(0, Math.min(tpPage, total - 1));\n  const start = tpPage * PER_PAGE;\n  const slice = zones.slice(start, start + PER_PAGE);\n\n  if (tpPage > 0) addTpButton(\"tp-prev\", \"◀\", () => { tpPage--; drawTpButtons(); });\n\n  slice.forEach((z, i) => {\n    addTpButton(`tp-z-${start + i}`, z.label, () => {\n      WA.nav.goToRoom(mapURL + z.id);\n      // pour laisser ouvert après TP, commente ces 2 lignes :\n      removeTpButtons(); tpOpen = false;\n    });\n  });\n\n  if (tpPage < total - 1) addTpButton(\"tp-next\", \"▶\", () => { tpPage++; drawTpButtons(); });\n  addTpButton(\"tp-close\", \"Fermer\", () => { removeTpButtons(); tpOpen = false; });\n}\nfunction addTpButton(id: string, label: string, cb: () => void) {\n  tpButtonIds.push(id);\n  (WA.ui as any).actionBar.addButton({ id, label, callback: cb, clickCallback: cb });\n}\nfunction removeTpButtons() {\n  const ab: any = WA.ui.actionBar;\n  tpButtonIds.forEach((id) => { try { ab.removeButton?.(id); } catch {} });\n  tpButtonIds = [];\n}\n\nexport {};\n"],"names":["log","a","err","mapURL","zones","tpOpen","tpPage","PER_PAGE","tpButtonIds","_a","toggleTeleportMenu","e","removeTpButtons","drawTpButtons","total","start","slice","addTpButton","z","i","id","label","cb","ab"],"mappings":"AAGA,MAAMA,EAAO,IAAIC,IAAa,QAAQ,IAAI,OAAQ,GAAGA,CAAC,EAChDC,EAAO,IAAID,IAAa,QAAQ,MAAM,OAAQ,GAAGA,CAAC,EAGlDE,EAAS,4CACTC,EAAyC,CAC7C,CAAE,GAAI,UAAe,MAAO,IAAK,EACjC,CAAE,GAAI,WAAe,MAAO,cAAe,EAC3C,CAAE,GAAI,YAAe,MAAO,eAAgB,EAC5C,CAAE,GAAI,YAAe,MAAO,cAAe,EAC3C,CAAE,GAAI,UAAe,MAAO,oBAAqB,EACjD,CAAE,GAAI,YAAe,MAAO,aAAc,EAC1C,CAAE,GAAI,cAAe,MAAO,YAAa,EACzC,CAAE,GAAI,SAAe,MAAO,IAAK,EACjC,CAAE,GAAI,UAAe,MAAO,SAAU,CACxC,EAGA,IAAIC,EAAS,GACTC,EAAS,EACb,MAAMC,EAAW,EACjB,IAAIC,EAAwB,CAAA,EAE5B,GAAG,OAAA,EAAS,KAAK,IAAM,CACrBR,EAAI,WAAW,EAGZ,GAAA,GAAG,UAAU,UAAU,CACxB,GAAI,iBACJ,MAAO,aACP,SAAU,IAAM,CA9BpB,IAAAS,EA+BU,GAAA,EAEEA,EAAA,mBAAI,MAAJ,MAAAA,EAAS,QAAY,GAAA,IAAI,QAAQ,kCAAkC,EAC3D,OAAA,KAAK,mCAAoC,SAAU,qBAAqB,CAAA,MAC9E,CACC,OAAA,KAAK,mCAAoC,SAAU,qBAAqB,CACjF,CACF,CAAA,CACD,EAGE,GAAA,GAAG,UAAU,UAAU,CACxB,GAAI,eACJ,MAAO,gBACP,SAAU,IAAMC,EAAmB,CAAA,CACpC,EAEDV,EAAI,eAAe,CACrB,CAAC,EAAE,MAAOW,GAAMT,EAAI,gBAAiBS,CAAC,CAAC,EAGvC,SAASD,GAAqB,CAC5B,GAAIL,EAAQ,CAAkBO,IAAYP,EAAA,GAAO,MAAQ,CAChDC,EAAA,EAAiBO,IAAYR,EAAA,EACxC,CACA,SAASQ,GAAgB,CACPD,IAEV,MAAAE,EAAQ,KAAK,IAAI,EAAG,KAAK,KAAKV,EAAM,OAASG,CAAQ,CAAC,EACnDD,EAAA,KAAK,IAAI,EAAG,KAAK,IAAIA,EAAQQ,EAAQ,CAAC,CAAC,EAChD,MAAMC,EAAQT,EAASC,EACjBS,EAAQZ,EAAM,MAAMW,EAAOA,EAAQR,CAAQ,EAE7CD,EAAS,GAAeW,EAAA,UAAW,IAAK,IAAM,CAAEX,IAAwBO,GAAA,CAAI,EAE1EG,EAAA,QAAQ,CAACE,EAAGC,IAAM,CACtBF,EAAY,QAAQF,EAAQI,CAAC,GAAID,EAAE,MAAO,IAAM,CAC9C,GAAG,IAAI,SAASf,EAASe,EAAE,EAAE,EAEbN,IAAYP,EAAA,EAAA,CAC7B,CAAA,CACF,EAEGC,EAASQ,EAAQ,GAAeG,EAAA,UAAW,IAAK,IAAM,CAAEX,IAAwBO,GAAA,CAAI,EAC5EI,EAAA,WAAY,SAAU,IAAM,CAAkBL,IAAYP,EAAA,EAAA,CAAQ,CAChF,CACA,SAASY,EAAYG,EAAYC,EAAeC,EAAgB,CAC9Dd,EAAY,KAAKY,CAAE,EAClB,GAAG,GAAW,UAAU,UAAU,CAAE,GAAAA,EAAI,MAAAC,EAAO,SAAUC,EAAI,cAAeA,CAAI,CAAA,CACnF,CACA,SAASV,GAAkB,CACnB,MAAAW,EAAU,GAAG,GAAG,UACVf,EAAA,QAASY,GAAO,CAnF9B,IAAAX,EAmFoC,GAAA,EAAEA,EAAAc,EAAG,eAAH,MAAAd,EAAA,KAAAc,EAAkBH,EAAE,MAAW,CAAC,CAAA,CAAG,EACvEZ,EAAc,CAAA,CAChB"}