{"version":3,"file":"main-e296b6e0.js","sources":["../../src/main.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n\n/* ============ LOGS ============ */\nconst L = {\n  log: (...a: any[]) => console.log(\"[WA]\", ...a),\n  err: (...a: any[]) => console.error(\"[WA]\", ...a),\n};\n\n/* ============ CONFIG ============ */\nconst MAP_URL = \"/@/ynov-1733302243/ynov_adventure/new-map\";\nconst ZONES: { id: string; label: string }[] = [\n  { id: \"#TPA-IA\", label: \"IA\" },\n  { id: \"#TPAINFO\", label: \"Informatique\" },\n  { id: \"#TPACYBER\", label: \"Cybersécurité\" },\n  { id: \"#TPAARCHI\", label: \"Architecture\" },\n  { id: \"#TPABIM\", label: \"Bâtiment Numérique\" },\n  { id: \"#TPAAUDIO\", label: \"Audiovisuel\" },\n  { id: \"#TPADIGITAL\", label: \"DIGITAL IA\" },\n  { id: \"#TPA3D\", label: \"3D\" },\n  { id: \"#TPAHUB\", label: \"Accueil\" },\n];\n\n/* ============ HELPERS ============ */\nfunction addButtonSafe(opts: {\n  id: string;\n  label: string;\n  onClick: () => void;\n  bgColor?: string;\n  isGradient?: boolean;\n}) {\n  const ab: any = (WA.ui as any)?.actionBar;\n  if (!ab?.addButton) {\n    L.err(\"actionBar.addButton introuvable\");\n    return;\n  }\n\n  const base: any = {\n    id: opts.id,\n    label: opts.label,\n    callback: opts.onClick,\n    clickCallback: opts.onClick,\n  };\n\n  try {\n    if (opts.bgColor !== undefined) base.bgColor = opts.bgColor;\n    if (opts.isGradient !== undefined) base.isGradient = opts.isGradient;\n    ab.addButton(base);\n  } catch {\n    try {\n      ab.addButton({\n        id: opts.id,\n        label: opts.label,\n        callback: opts.onClick,\n        clickCallback: opts.onClick,\n      });\n    } catch (e) {\n      L.err(`Impossible d'ajouter le bouton ${opts.id}:`, e);\n    }\n  }\n}\n\n/* ======= ÉTAT TÉLÉPORTATION ======= */\nconst MAIN_TP_BTN_ID = \"teleport-btn\";\nlet tpOpen = false;\nlet tpButtonIds: string[] = [];\n\n/* ============ INIT ============ */\nWA.onInit()\n  .then(() => {\n    addButtonSafe({\n      id: MAIN_TP_BTN_ID,\n      label: \"Téléportation\",\n      bgColor: \"#2ea7ff\",\n      isGradient: true,\n      onClick: () => toggleTeleportMenu(),\n    });\n  })\n  .catch((e) => L.err(\"onInit error:\", e));\n\n/* ============ TÉLÉPORTATION (sans pagination, WA gère l’affichage) ============ */\nfunction toggleTeleportMenu() {\n  if (tpOpen) closeTeleportMenu();\n  else openTeleportMenu();\n}\n\nfunction openTeleportMenu() {\n  if (tpOpen) return;\n  tpOpen = true;\n  drawTpButtons();\n}\n\nfunction closeTeleportMenu() {\n  removeTpButtons();\n  tpOpen = false;\n}\n\nfunction drawTpButtons() {\n  removeTpButtons();\n\n  // Crée un bouton pour chaque zone\n  ZONES.forEach((z, idx) => {\n    addTpBtn(`tp-z-${idx}`, z.label, () => {\n      try {\n        WA.nav.goToRoom(MAP_URL + z.id);\n      } catch (e) {\n        L.err(\"goToRoom error:\", e);\n      }\n      closeTeleportMenu();\n    });\n  });\n\n  // Bouton de fermeture\n  addTpBtn(\"tp-close\", \"✖\", () => closeTeleportMenu());\n}\n\nfunction addTpBtn(id: string, label: string, cb: () => void) {\n  tpButtonIds.push(id);\n  const ab: any = (WA.ui as any)?.actionBar;\n  try {\n    ab.addButton({ id, label, callback: cb, clickCallback: cb });\n  } catch (e) {\n    L.err(`Erreur lors de l'ajout du bouton ${id}:`, e);\n  }\n}\n\nfunction removeTpButtons() {\n  const ab: any = (WA.ui as any)?.actionBar;\n  tpButtonIds.forEach((id) => {\n    try {\n      ab.removeButton?.(id);\n    } catch {}\n  });\n  tpButtonIds = [];\n}\n\nexport {};\n"],"names":["L","a","MAP_URL","ZONES","addButtonSafe","opts","_a","ab","base","e","MAIN_TP_BTN_ID","tpOpen","tpButtonIds","toggleTeleportMenu","closeTeleportMenu","openTeleportMenu","drawTpButtons","removeTpButtons","z","idx","addTpBtn","id","label","cb"],"mappings":"AAGA,MAAMA,EAAI,CACR,IAAK,IAAIC,IAAa,QAAQ,IAAI,OAAQ,GAAGA,CAAC,EAC9C,IAAK,IAAIA,IAAa,QAAQ,MAAM,OAAQ,GAAGA,CAAC,CAClD,EAGMC,EAAU,4CACVC,EAAyC,CAC7C,CAAE,GAAI,UAAW,MAAO,IAAK,EAC7B,CAAE,GAAI,WAAY,MAAO,cAAe,EACxC,CAAE,GAAI,YAAa,MAAO,eAAgB,EAC1C,CAAE,GAAI,YAAa,MAAO,cAAe,EACzC,CAAE,GAAI,UAAW,MAAO,oBAAqB,EAC7C,CAAE,GAAI,YAAa,MAAO,aAAc,EACxC,CAAE,GAAI,cAAe,MAAO,YAAa,EACzC,CAAE,GAAI,SAAU,MAAO,IAAK,EAC5B,CAAE,GAAI,UAAW,MAAO,SAAU,CACpC,EAGA,SAASC,EAAcC,EAMpB,CA1BH,IAAAC,EA2BQ,MAAAC,GAAWD,EAAA,GAAG,KAAH,YAAAA,EAAe,UAC5B,GAAA,EAACC,GAAA,MAAAA,EAAI,WAAW,CAClBP,EAAE,IAAI,iCAAiC,EACvC,MACF,CAEA,MAAMQ,EAAY,CAChB,GAAIH,EAAK,GACT,MAAOA,EAAK,MACZ,SAAUA,EAAK,QACf,cAAeA,EAAK,OAAA,EAGlB,GAAA,CACEA,EAAK,UAAY,SAAWG,EAAK,QAAUH,EAAK,SAChDA,EAAK,aAAe,SAAWG,EAAK,WAAaH,EAAK,YAC1DE,EAAG,UAAUC,CAAI,CAAA,MACX,CACF,GAAA,CACFD,EAAG,UAAU,CACX,GAAIF,EAAK,GACT,MAAOA,EAAK,MACZ,SAAUA,EAAK,QACf,cAAeA,EAAK,OAAA,CACrB,QACMI,EAAG,CACVT,EAAE,IAAI,kCAAkCK,EAAK,EAAE,IAAKI,CAAC,CACvD,CACF,CACF,CAGA,MAAMC,EAAiB,eACvB,IAAIC,EAAS,GACTC,EAAwB,CAAA,EAG5B,GAAG,OAAA,EACA,KAAK,IAAM,CACIR,EAAA,CACZ,GAAIM,EACJ,MAAO,gBACP,QAAS,UACT,WAAY,GACZ,QAAS,IAAMG,EAAmB,CAAA,CACnC,CACH,CAAC,EACA,MAAO,GAAMb,EAAE,IAAI,gBAAiB,CAAC,CAAC,EAGzC,SAASa,GAAqB,CACxBF,EAA0BG,IACRC,GACxB,CAEA,SAASA,GAAmB,CACtBJ,IACKA,EAAA,GACKK,IAChB,CAEA,SAASF,GAAoB,CACXG,IACPN,EAAA,EACX,CAEA,SAASK,GAAgB,CACPC,IAGVd,EAAA,QAAQ,CAACe,EAAGC,IAAQ,CACxBC,EAAS,QAAQD,CAAG,GAAID,EAAE,MAAO,IAAM,CACjC,GAAA,CACF,GAAG,IAAI,SAAShB,EAAUgB,EAAE,EAAE,QACvBT,EAAG,CACRT,EAAA,IAAI,kBAAmBS,CAAC,CAC5B,CACkBK,GAAA,CACnB,CAAA,CACF,EAGDM,EAAS,WAAY,IAAK,IAAMN,EAAmB,CAAA,CACrD,CAEA,SAASM,EAASC,EAAYC,EAAeC,EAAgB,CAhH7D,IAAAjB,EAiHEM,EAAY,KAAKS,CAAE,EACb,MAAAd,GAAWD,EAAA,GAAG,KAAH,YAAAA,EAAe,UAC5B,GAAA,CACCC,EAAA,UAAU,CAAE,GAAAc,EAAI,MAAAC,EAAO,SAAUC,EAAI,cAAeA,EAAI,QACpDd,EAAG,CACVT,EAAE,IAAI,oCAAoCqB,CAAE,IAAKZ,CAAC,CACpD,CACF,CAEA,SAASQ,GAAkB,CA1H3B,IAAAX,EA2HQ,MAAAC,GAAWD,EAAA,GAAG,KAAH,YAAAA,EAAe,UACpBM,EAAA,QAASS,GAAO,CA5H9B,IAAAf,EA6HQ,GAAA,EACFA,EAAAC,EAAG,eAAH,MAAAD,EAAA,KAAAC,EAAkBc,EAAE,MACd,CAAC,CAAA,CACV,EACDT,EAAc,CAAA,CAChB"}