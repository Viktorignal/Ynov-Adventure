{"version":3,"file":"main-be9688fb.js","sources":["../../src/main.ts"],"sourcesContent":["/// <reference types=\"@workadventure/iframe-api-typings\" />\n\nconsole.log(\"[WA] Script file loaded\");\n\nlet clockPopup: any | undefined = undefined;\nlet tpPopup: any | undefined = undefined;\n\n/* === CONFIG === */\nconst mapURL = \"/@/ynov-1733302243/ynov_adventure/new-map\";\nconst zones = [\n  { id: \"#TPA-IA\",     label: \"IA\" },\n  { id: \"#TPAINFO\",    label: \"Informatique\" },\n  { id: \"#TPACYBER\",   label: \"Cybers√©curit√©\" },\n  { id: \"#TPAARCHI\",   label: \"Architecture\" },\n  { id: \"#TPABIM\",     label: \"B√¢timent Num√©rique\" },\n  { id: \"#TPAAUDIO\",   label: \"Audiovisuel\" },\n  { id: \"#TPADIGITAL\", label: \"DIGITAL IA\" },\n  { id: \"#TPA3D\",      label: \"3D\" },\n  { id: \"#TPAHUB\",     label: \"Accueil\" },\n];\n// nombre d‚Äôoptions par page dans la popup\nconst PAGE_SIZE = 4;\n/* ============== */\n\nWA.onInit()\n  .then(() => {\n    console.log(\"[WA] onInit OK\");\n\n    // (Facultatif) Popup heure sur la zone 'clock'\n    try {\n      WA.room.area.onEnter(\"clock\").subscribe(() => {\n        const d = new Date();\n        const pad = (n: number) => String(n).padStart(2, \"0\");\n        const time = `${pad(d.getHours())}:${pad(d.getMinutes())}`;\n        clockPopup = WA.ui.openPopup(\"clockPopup\", \"It's \" + time, []);\n      });\n      WA.room.area.onLeave(\"clock\").subscribe(() => {\n        try { clockPopup?.close?.(); } catch {}\n        clockPopup = undefined;\n      });\n    } catch (e) {\n      console.warn(\"[WA] clock init warn:\", e);\n    }\n\n    // Bouton CANDIDATER ‚Äî onglet uniquement\n    WA.ui.actionBar.addButton({\n      id: \"candidater-btn\",\n      label: \"üü° Candidater\",\n      callback: () => {\n        try {\n          if ((WA as any)?.nav?.openTab) (WA as any).nav.openTab(\"https://www.ynov.com/candidature\");\n          else window.open(\"https://www.ynov.com/candidature\", \"_blank\", \"noopener,noreferrer\");\n        } catch {\n          window.open(\"https://www.ynov.com/candidature\", \"_blank\", \"noopener,noreferrer\");\n        }\n      },\n    });\n\n    // Bouton T√âL√âPORTATION ‚Äî popup verticale pagin√©e\n    WA.ui.actionBar.addButton({\n      id: \"teleport-btn\",\n      label: \"üß≠ T√©l√©portation\",\n      callback: () => openTeleportPopup(0),\n    });\n\n    console.log(\"[WA] Buttons added\");\n  })\n  .catch((e) => console.error(\"[WA] onInit error:\", e));\n\n/* === T√©l√©portation: popup verticale native + pagination === */\nfunction openTeleportPopup(pageIndex: number) {\n  // s√©curit√© : bornes\n  const totalPages = Math.ceil(zones.length / PAGE_SIZE);\n  const page = Math.max(0, Math.min(pageIndex, Math.max(0, totalPages - 1)));\n\n  // ferme l‚Äôancienne popup si ouverte\n  try { tpPopup?.close?.(); } catch {}\n  tpPopup = undefined;\n\n  // slice des options pour la page courante\n  const start = page * PAGE_SIZE;\n  const items = zones.slice(start, start + PAGE_SIZE);\n\n  // boutons ‚Äúdestination‚Äù\n  const buttons = items.map((z) => ({\n    label: z.label,\n    callback: () => {\n      WA.nav.goToRoom(mapURL + z.id);\n      try { tpPopup?.close?.(); } catch {}\n      tpPopup = undefined;\n    },\n  }));\n\n  // zone de navigation (pr√©c√©dent/suivant) si plusieurs pages\n  const nav: { label: string; callback: () => void }[] = [];\n  if (page > 0) {\n    nav.push({\n      label: \"‚óÄ Pr√©c√©dent\",\n      callback: () => openTeleportPopup(page - 1),\n    });\n  }\n  if (page < totalPages - 1) {\n    nav.push({\n      label: \"Suivant ‚ñ∂\",\n      callback: () => openTeleportPopup(page + 1),\n    });\n  }\n\n  // bouton Fermer\n  const closeBtn = {\n    label: \"Fermer\",\n    callback: () => {\n      try { tpPopup?.close?.(); } catch {}\n      tpPopup = undefined;\n    },\n  };\n\n  // assemble : d‚Äôabord les options, puis nav, puis Fermer\n  const popupButtons = [...buttons, ...nav, closeBtn];\n\n  // corps de la popup\n  const header = totalPages > 1\n    ? `T√©l√©portation (page ${page + 1}/${totalPages})`\n    : \"T√©l√©portation\";\n  const body = `${header}\\n\\nChoisissez une destination :`;\n\n  // affiche la popup (verticale nativement)\n  tpPopup = WA.ui.openPopup(\"teleportPopup\", body, popupButtons);\n}\n\n\nexport {};\n"],"names":["clockPopup","tpPopup","mapURL","zones","PAGE_SIZE","d","pad","n","time","_a","e","openTeleportPopup","pageIndex","totalPages","page","start","buttons","z","nav","closeBtn","popupButtons","body"],"mappings":"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"}